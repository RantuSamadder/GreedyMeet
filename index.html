<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>GreedyMeet</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{
  margin:0;
  font-family:'Courier New', monospace;
  background:#03040a;
  color:#00ffe0;
}

/* Binary background */
@keyframes floatBits{
  from{transform:translateY(0);opacity:.5}
  to{transform:translateY(-120vh);opacity:.8}
}
.binary{
  position:fixed;
  bottom:-10vh;
  font-size:11px;
  color:rgba(0,255,200,.25);
  animation:floatBits linear infinite;
  pointer-events:none;
  z-index:-1;
}

/* Cards */
.card{
  background:rgba(0,255,200,.07);
  border:1px solid #00ffc8;
  border-radius:14px;
  padding:16px;
  margin:16px auto;
  max-width:1100px;
  box-shadow:0 0 16px #00ffc825;
}

/* Inputs */
input,select,button{
  padding:10px;
  margin:6px 0;
  border-radius:6px;
  border:1px solid #00ffc8;
  background:#081616;
  color:#00ffe0;
}
button{
  cursor:pointer;
  font-weight:bold;
}
button:hover{background:#003737}

/* Spinner */
.spinner{
  display:none;
  width:16px;
  height:16px;
  border:3px solid #00ffc844;
  border-top:3px solid #00ffc8;
  border-radius:50%;
  animation:spin 1s linear infinite;
  margin-left:8px;
}
@keyframes spin{to{transform:rotate(360deg)}}

/* Dropdown */
.dropdown-content{
  display:none;
  background:#081818;
  border:1px solid #00ffc8;
  padding:8px;
  max-height:200px;
  overflow:auto;
}

/* FLEX LAYOUT */
.flex{
  display:flex;
  gap:16px;
}
@media(min-width:768px){
  .left,.right{flex:1}
}
@media(max-width:767px){
  .flex{flex-direction:column}
  button,input,select{width:100%}
}

/* OFF DAY INLINE */
.offday-row{
  display:flex;
  align-items:center;
  gap:8px;
  margin:6px 0;
}
.offday-row input{
  width:auto;
  margin:0;
}

/* Highlight */
.highlight{
  background:#001f1f;
  padding:8px;
  border-left:4px solid #00ffc8;
  margin:6px 0;
}

.toggle-btn{
  background:#002828;
  margin-bottom:8px;
}

/* FOOTER */
footer{
  text-align:center;
  padding:14px;
  margin-top:20px;
  font-size:13px;
  color:#00ffc8;
  opacity:.7;
  border-top:1px solid #00ffc833;
}
footer span{
  opacity:.9;
}
</style>
</head>

<body>

<script>
for(let i=0;i<120;i++){
  const b=document.createElement("div");
  b.className="binary";
  b.style.left=Math.random()*100+"vw";
  b.style.animationDuration=(6+Math.random()*12)+"s";
  b.textContent=Math.random()>.5?"0":"1";
  document.body.appendChild(b);
}
</script>

<div class="card">
<h2 style="text-align:center">üìä GreedyMeet ‚Äì Meeting Slot Finder for Groups</h2>

<div class="flex">

<!-- LEFT -->
<div class="left">

<button class="toggle-btn" onclick="toggleForm()">‚ûï Submit Your Class Schedule</button>

<form id="scheduleForm" style="display:none">

<input id="studentID" placeholder="Student ID" required>
<input id="group" placeholder="Group Name" required>

<select id="day">
<option>Saturday</option><option>Sunday</option><option>Monday</option>
<option>Tuesday</option><option>Wednesday</option>
<option>Thursday</option><option>Friday</option>
</select>

<div class="offday-row">
  <input type="checkbox" id="offDay">
  <label for="offDay">OFF day</label>
</div>

<div id="slotBox">
<button type="button" onclick="toggleSlots()">Select Time Slots ‚ñº</button>
<div class="dropdown-content" id="slotDropdown">
<label><input type="checkbox" value="08:30‚Äì09:50"> 08:30‚Äì09:50</label><br>
<label><input type="checkbox" value="10:00‚Äì11:20"> 10:00‚Äì11:20</label><br>
<label><input type="checkbox" value="13:30‚Äì14:50"> 13:30‚Äì14:50</label><br>
<label><input type="checkbox" value="15:00‚Äì16:20"> 15:00‚Äì16:20</label>
</div>
</div>

<button type="submit">Submit</button>
</form>

<hr style="border-color:#00ffc833">

<input id="dashboardGroup" placeholder="Group Name">

<select id="daySelect">
<option>Saturday</option><option>Sunday</option><option>Monday</option>
<option>Tuesday</option><option>Wednesday</option>
<option>Thursday</option><option>Friday</option>
</select>

<button onclick="loadChart()">
  üîç Find
  <span class="spinner" id="loader"></span>
</button>

<p>Total Students: <b><span id="totalStudents">0</span></b></p>

<div class="highlight" id="bestSlot">Best Slot: </div>
<div class="highlight" id="bestDay">Best Day: </div>

</div>

<!-- RIGHT -->
<div class="right">
<canvas id="freeTimeChart"></canvas>
</div>

</div>
</div>

<footer>
  <span>¬© Fall 25 GreedyMeet | Algorithm Lab Project ‚Ä¢ All rights reserved.</span>
</footer>

<script>
const SCRIPT_URL="https://script.google.com/macros/s/AKfycbxlG57FNrAulG6SFlYp4m7BUG5BEaqgecY1lQR-0sRf8rfqjvK5L7meeDgiTgXh44duqQ/exec";

function toggleForm(){
  scheduleForm.style.display =
    scheduleForm.style.display==="none"?"block":"none";
}
function toggleSlots(){
  slotDropdown.style.display =
    slotDropdown.style.display==="block"?"none":"block";
}
offDay.onchange=()=>{
  slotBox.style.display = offDay.checked ? "none" : "block";
};

scheduleForm.onsubmit=e=>{
  e.preventDefault();
  const slots = offDay.checked
    ? ["OFF"]
    : [...slotDropdown.querySelectorAll("input:checked")].map(x=>x.value);

  fetch(SCRIPT_URL,{
    method:"POST",
    body:JSON.stringify({
      studentID:studentID.value,
      group:group.value,
      day:day.value,
      timeSlots:slots
    })
  }).then(()=>alert("Submitted ‚úÖ"));
};

let chart;
function loadChart(){
  loader.style.display="inline-block";

  fetch(`${SCRIPT_URL}?group=${dashboardGroup.value}`)
  .then(r=>r.json())
  .then(data=>{
    loader.style.display="none";
    totalStudents.textContent=data.totalStudents;

    const dayData=data.freeTime[daySelect.value];
    const labels=Object.keys(dayData);
    const values=Object.values(dayData);

    const ctx = freeTimeChart.getContext("2d");
    const gradient = ctx.createLinearGradient(0,0,0,300);
    gradient.addColorStop(0,"#00ffe0");
    gradient.addColorStop(1,"#007f73");

    if(chart) chart.destroy();
    chart=new Chart(freeTimeChart,{
      type:"bar",
      data:{
        labels,
        datasets:[{
          data:values,
          label:"Free %",
          backgroundColor:gradient,
          borderColor:"#00ffc8",
          borderWidth:1,
          borderRadius:6
        }]
      },
      options:{
        scales:{
          y:{beginAtZero:true,max:100,grid:{color:"#00ffc822"}},
          x:{grid:{color:"#00ffc811"}}
        }
      }
    });

    let max=Math.max(...values);
    let slot=labels[values.indexOf(max)];
    bestSlot.textContent=`Best Slot: ${slot} (${max}% free)`;

    let bestD="",bestAvg=0;
    for(const d in data.freeTime){
      let avg=Object.values(data.freeTime[d]).reduce((a,b)=>a+b,0)/labels.length;
      if(avg>bestAvg){bestAvg=avg;bestD=d;}
    }
    bestDay.textContent=`Best Day: ${bestD} (${bestAvg.toFixed(1)}%)`;
  });
}
</script>

</body>
</html>
